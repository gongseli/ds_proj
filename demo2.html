<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AIç«¥è¯æ•…äº‹ç”Ÿæˆå™¨</title>
    <!-- å¼•å…¥jQueryåº“ -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        /*ç§»åŠ¨ç«¯é¦–å±æ ·å¼ [[6,7]]*/
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            background: #f5f5f5;
        }

        .container {
            padding: 15px;
            max-width: 600px;
            margin: 0 auto;
        }

        /*å“åº”å¼ç½‘æ ¼å¸ƒå±€ [[6,9]]*/
        .grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        /*å›¾ç‰‡å¡ç‰‡æ ·å¼ [[12,14]]*/
        .card {
            border: 2px solid #ddd;
            border-radius: 12px;
            -webkit-border-radius: 12px;
            /*Safariå…¼å®¹ [[5]]*/
            overflow: hidden;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .card.selected {
            border-color: #ff6b6b;
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
        }

        .card img {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }

        .card p {
            text-align: center;
            padding: 8px;
            font-size: 14px;
        }

        /*åœºæ™¯é€‰æ‹©æ ·å¼ [[10,12]]*/
        .scene-item {
            position: relative;
            margin: 10px 0;
        }

        .scene-radio {
            position: absolute;
            opacity: 0;
        }

        .scene-label {
            display: block;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 12px;
            background: white;
            font-size: 16px;
        }

        .scene-radio:checked+.scene-label {
            border-color: #4ecdc4;
            background: #f0fffe;
        }

        /*æŒ‰é’®æ ·å¼ [[6,14]]*/
        .btn {
            display: block;
            width: 100%;
            padding: 12px;
            background: #4ecdc4;
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            margin: 20px 0;
            touch-action: manipulation;
            /*ä¼˜åŒ–è§¦æ‘¸å“åº” [[5]]*/
        }

        #story-output {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            white-space: pre-wrap;
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- åŠ¨ç‰©é€‰æ‹©æ­¥éª¤ -->
        <div id="step1">
            <h2>é€‰æ‹©3ç§åŠ¨ç‰©ä¼™ä¼´</h2>
            <div class="grid">
                <!-- å‡æ•°æ®ç¤ºä¾‹ï¼Œå®é™…éœ€è¦æ›¿æ¢å›¾ç‰‡è·¯å¾„ [[10]] -->
                <div class="card" data-animal="å…”å­">
                    <img src="https://q0.itc.cn/q_70/images01/20240307/3cdb0bbef0864638898dff1dfea1f967.jpeg" alt="å…”å­">
                    <p>ğŸ° èªæ˜å…”</p>
                </div>
                <div class="card" data-animal="å…”å­">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSsrwuk-MuO34fNvm9B2lYCcIp8rtoW_-R8IQ&s" alt="å¤§è±¡">
                    <p>å¤§è±¡</p>
                </div>
                <div class="card" data-animal="å…”å­">
                    <img src="https://q0.itc.cn/q_70/images01/20240307/3cdb0bbef0864638898dff1dfea1f967.jpeg" alt="å…”å­">
                    <p>ğŸ° èªæ˜å…”</p>
                </div>
                <div class="card" data-animal="å…”å­">
                    <img src="https://q0.itc.cn/q_70/images01/20240307/3cdb0bbef0864638898dff1dfea1f967.jpeg" alt="å…”å­">
                    <p>ğŸ° èªæ˜å…”</p>
                </div>
                <div class="card" data-animal="å…”å­">
                    <img src="https://q0.itc.cn/q_70/images01/20240307/3cdb0bbef0864638898dff1dfea1f967.jpeg" alt="å…”å­">
                    <p>ğŸ° èªæ˜å…”</p>
                </div>
                <div class="card" data-animal="å…”å­">
                    <img src="https://q0.itc.cn/q_70/images01/20240307/3cdb0bbef0864638898dff1dfea1f967.jpeg" alt="å…”å­">
                    <p>ğŸ° èªæ˜å…”</p>
                </div>
                <div class="card" data-animal="å…”å­">
                    <img src="https://q0.itc.cn/q_70/images01/20240307/3cdb0bbef0864638898dff1dfea1f967.jpeg" alt="å…”å­">
                    <p>ğŸ° èªæ˜å…”</p>
                </div>
                <div class="card" data-animal="å…”å­">
                    <img src="https://q0.itc.cn/q_70/images01/20240307/3cdb0bbef0864638898dff1dfea1f967.jpeg" alt="å…”å­">
                    <p>ğŸ° èªæ˜å…”</p>
                </div>
                <div class="card" data-animal="å…”å­">
                    <img src="https://q0.itc.cn/q_70/images01/20240307/3cdb0bbef0864638898dff1dfea1f967.jpeg" alt="å…”å­">
                    <p>ğŸ° èªæ˜å…”</p>
                </div>
                <div class="card" data-animal="å…”å­">
                    <img src="https://q0.itc.cn/q_70/images01/20240307/3cdb0bbef0864638898dff1dfea1f967.jpeg" alt="å…”å­">
                    <p>ğŸ° èªæ˜å…”</p>
                </div>
                <!-- é‡å¤å…¶ä»–9ç§åŠ¨ç‰©... -->
            </div>
        </div>

        <!-- åœºæ™¯é€‰æ‹©æ­¥éª¤ -->
        <div id="step2" style="display:none;">
            <h2>é€‰æ‹©å†’é™©åœºæ™¯</h2>
            <!-- å‡æ•°æ®ç¤ºä¾‹ [[10]] -->
            <div class="scene-item">
                <input class="scene-radio" type="radio" name="scene" id="scene1" value="é­”æ³•æ£®æ—">
                <label class="scene-label" for="scene1">ğŸŒ³ é­”æ³•æ£®æ—</label>
            </div>
            <div class="scene-item">
                <input class="scene-radio" type="radio" name="scene" id="scene2" value="åŸå¸‚">
                <label class="scene-label" for="scene2">ğŸŒ³ åŸå¸‚</label>
            </div>
            <div class="scene-item">
                <input class="scene-radio" type="radio" name="scene" id="scene3" value="å†œæ‘">
                <label class="scene-label" for="scene3">ğŸŒ³ å†œæ‘</label>
            </div>
            <div class="scene-item">
                <input class="scene-radio" type="radio" name="scene" id="scene4" value="ä¹¡é—´">
                <label class="scene-label" for="scene4">ğŸŒ³ ä¹¡é—´</label>
            </div>
        </div>

        <!-- æ•…äº‹è¾“å‡º -->
        <button onclick="callDeepSeek()" id=" generate-btn" class="btn">ç”Ÿæˆç«¥è¯æ•…äº‹</button>
        <div id="story-output"></div>
    </div>

    <script>
        // å·²é€‰åŠ¨ç‰©æ•°ç»„
        let selectedAnimals = []

        // åŠ¨ç‰©é€‰æ‹©é€»è¾‘ [[1,3]]
        $('.card').click(function () {
            const animal = $(this).data('animal')
            if ($(this).hasClass('selected')) {
                $(this).removeClass('selected')
                selectedAnimals = selectedAnimals.filter(a => a !== animal)
            } else {
                if (selectedAnimals.length < 3) {
                    $(this).addClass('selected')
                    selectedAnimals.push(animal)
                }
            }

            // é€‰æ»¡3ä¸ªåæ˜¾ç¤ºåœºæ™¯é€‰æ‹©
            if (selectedAnimals.length === 3) {
                $('#step1').hide()
                $('#step2').show()
            }
        })

        // åœºæ™¯é€‰æ‹©é€»è¾‘
        $('.scene-radio').change(function () {
            if ($(this).is(':checked')) {
                $('#generate-btn').show()
            }
        })

        // ç”Ÿæˆæ•…äº‹é€»è¾‘ [[1]]
        /*$('#generate-btn').click(function () {
            const scene = $('input[name="scene"]:checked').val()

            // å‡APIè°ƒç”¨ç¤ºä¾‹ï¼Œå®é™…éœ€è¦æ›¿æ¢ä¸ºçœŸå®æ¥å£ [[æ³¨é‡Šè¯´æ˜]]
            $.post('https://api.example.com/deepseek-v3', {
                // è¯·åœ¨æ­¤å¤„å¡«å†™å®é™…APIå‚æ•°
                animals: selectedAnimals,
                scene: scene,
                api_key: 'sk-wrcbwflldrmksxylmlkhouvjbhpbztmisxkzwwpjmyoeuhrp' // éœ€è¦æ›¿æ¢ä¸ºçœŸå®APIå¯†é’¥
            }, function (response) {
                $('#story-output').text(response.story)
            }).fail(function () {
                // æ¨¡æ‹Ÿå‡æ•°æ®è¿”å›
                const demoStory = `${selectedAnimals.join('ã€')}åœ¨${scene}å±•å¼€å†’é™©...` // ç¤ºä¾‹å‡æ•°æ®
                $('#story-output').text(demoStory)
            })
        })*/
        const API_KEY = 'sk-wrcbwflldrmksxylmlkhouvjbhpbztmisxkzwwpjmyoeuhrp'; // [[3,6,15]]
        const MODEL = 'deepseek-ai/DeepSeek-V3'; // [[3,9,15]]

        async function callDeepSeek() {
            const scene = $('input[name="scene"]:checked').val()

            const inputText = `è®¾è®¡ä¸€ä¸ª${selectedAnimals.join('ã€')}åœ¨${scene}å±•å¼€å†’é™©çš„50å­—ç«¥è¯æ•…äº‹`
            $('#story-output').text("æ€è€ƒä¸­")
            //const responseArea = document.getElementById('response');
            //responseArea.innerHTML = "æ€è€ƒä¸­...";

            try {
                const response = await fetch('https://api.siliconflow.cn/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: MODEL,
                        messages: [{
                            role: "user",
                            content: inputText
                        }],
                        temperature: 0.7
                    })
                });

                const data = await response.json();
                $('#story-output').text(data.choices[0].message.content +
                    `<br>æœ¬æ¬¡æ¶ˆè€—: ${data.usage.total_tokens} tokens`)
                //responseArea.innerHTML = data.choices[0].message.content +
                //    `<br>æœ¬æ¬¡æ¶ˆè€—: ${data.usage.total_tokens} tokens`; // [[2,11,12]]
            } catch (error) {
                $('#story-output').text("è¯·æ±‚å¤±è´¥: " + error.message)
            }
        }
    </script>
</body>

</html>
